<template>
  <div class="sidebar-box">
    <el-menu class="el-menu-vertical-demo">
      <el-popover v-for="menu,index in menuItems"
        :key="index"
        :visible-arrow="false"
        :ref="menu.ref"
        trigger="hover"
        placement="right"
        popper-class="sidebar-popover">
        <el-row :gutter="20">
          <el-col v-for="child, index in menu.children"
            :key="index"
            :span="12">
            <h3>{{child.label}}</h3>
            <el-button type="text" v-for="child,index in child.children" :key="index" @click="onClick(menu.ref, child)">{{child.label}}</el-button>
          </el-col>
        </el-row>
        <div slot="reference">
          <el-menu-item :index="menu.value">{{menu.label}}</el-menu-item>
        </div>
      </el-popover>
    </el-menu>
  </div>
</template>

<script>
export default {
  name: 'v-side-bar',
  data () {
    return {
      menuItems: [
        {
          label: '常用',
          value: '常用',
          ref: 'common',
          children: [
            {
              children: [
                {
                  label: '单据中心',
                  route: '/common/documents'
                }, {
                  label: '单据草稿',
                  route: '/common/draft'
                }, {
                  label: '库存状况',
                  route: '/stock/stock'
                }, {
                  label: '导入记录',
                  route: '/common/import-records'
                }
              ]
            }
          ]
        }, {
          label: '商品',
          value: '商品',
          ref: 'product',
          children: [
            {
              label: '商品',
              children: [
                {
                  label: '商品列表',
                  route: '/product/list'
                }, {
                  label: 'SKU列表',
                  route: '/product/sku'
                }, {
                  label: '预设价管理',
                  route: '/product/preset-price'
                }
              ]
            }
          ]
        }, {
          label: '库存',
          value: '库存',
          ref: 'stock',
          children: [
            {
              label: '库存管理',
              children: [
                {
                  label: '库存状况',
                  route: '/stock/stock'
                }, {
                  label: '库存报损',
                  route: '/stock/loss'
                }, {
                  label: '库存报溢',
                  route: '/stock/overflow'
                }
              ]
            }
          ]
        }, {
          label: '销售',
          value: '销售',
          ref: 'sales',
          children: [
            {
              label: '销售管理',
              children: [
                {
                  label: '新订单',
                  route: '/sales/new-order'
                }, {
                  label: '确认订单',
                  route: '/sales/sure-order'
                }, {
                  label: '拣货单管理',
                  route: '/sales/pick-list'
                }, {
                  label: '申请取消订单',
                  route: '/sales/cancel-order'
                }, {
                  label: '全部订单管理',
                  route: '/sales/all-order'
                }, {
                  label: '新增销售订单',
                  route: '/sales/add-order/0'
                }
              ]
            }, {
              label: '销售出库',
              children: [
                {
                  label: '销售出库单',
                  route: '/sales/sale-out'
                }
              ]
            }, {
              label: '销售退货',
              children: [
                {
                  label: '销售退货单',
                  route: '/sales/receipt-order/0'
                }
              ]
            }
          ]
        }, {
          label: '进货',
          value: '进货',
          ref: 'purchase',
          children: [
            {
              label: '进货订单',
              children: [
                {
                  label: '新增进货订单',
                  route: '/purchase/added-purchase/0'
                }, {
                  label: '进货订单管理',
                  route: '/purchase/management-purchase'
                }
              ]
            }, {
              label: '进货入库',
              children: [
                {
                  label: '进货入库单',
                  route: '/purchase/purchas-warehous/0'
                }, {
                  label: '进货退货单',
                  route: '/purchase/refunds-purchase/0'
                }
              ]
            }
          ]
        }, {
          label: '资料',
          value: '资料',
          ref: 'profile',
          children: [
            {
              label: '往来单位',
              children: [
                {
                  label: '往来单位列表',
                  route: '/profile/contacts'
                }
              ]
            }, {
              label: '存货仓库',
              children: [
                {
                  label: '仓库设置',
                  route: '/profile/warehouse'
                }
              ]
            }, {
              label: '职员权限',
              children: [
                {
                  label: '职员权限设置',
                  route: '/profile/staff'
                }
              ]
            }, {
              label: '账户',
              children: [
                {
                  label: '账户设置',
                  route: '/profile/accounts'
                }
              ]
            }, {
              label: '分组',
              children: [
                {
                  label: '分组配置',
                  route: '/profile/groups'
                }
              ]
            }
          ]
        }, {
          label: '财务',
          value: '财务',
          ref: 'financial',
          children: [
            {
              children: [
                {
                  label: '单据对账表',
                  route: '/financial/reconciliation'
                }, {
                  label: '单据结算表',
                  route: '/financial/settlement'
                }, {
                  label: '付款单',
                  route: '/financial/payment'
                }, {
                  label: '收款单',
                  route: '/financial/receipt'
                }, {
                  label: '费用单',
                  route: '/financial/cost'
                }, {
                  label: '收款单对账',
                  route: '/financial/receipt-recon'
                }
              ]
            }, {
              label: '乐来已对账',
              children: [
                {
                  label: '特价补贴（收款）',
                  route: '/financial/checked/subsidies'
                }, {
                  label: '零钱补贴（收款）',
                  route: '/financial/checked/balance'
                }, {
                  label: '供应商返点（付款）',
                  route: '/financial/checked/rebates'
                }, {
                  label: '提点（付款）',
                  route: '/financial/checked/commission'
                }, {
                  label: '优惠分摊（收款）',
                  route: '/financial/checked/apportion'
                }
              ]
            }, {
              label: '乐来待对账',
              children: [
                {
                  label: '特价补贴（收款）',
                  route: '/financial/unchecked/subsidies'
                }, {
                  label: '零钱补贴（收款）',
                  route: '/financial/unchecked/balance'
                }, {
                  label: '供应商返点（付款）',
                  route: '/financial/unchecked/rebates'
                }, {
                  label: '提点（付款）',
                  route: '/financial/unchecked/commission'
                }, {
                  label: '优惠分摊（收款）',
                  route: '/financial/unchecked/apportion'
                }
              ]
            }
          ]
        }, {
          label: '报表',
          value: '报表',
          ref: 'report',
          children: [
            {
              label: '销售报表',
              children: [
                {
                  label: '销售统计年报',
                  route: '/report/annual-sale-stats'
                }, {
                  label: '销售统计月报',
                  route: '/report/month-sale-stats'
                }
              ]
            }, {
              label: '商品销售统计',
              children: [
                {
                  label: '商品销售列表',
                  route: '/report/sale-list'
                }
              ]
            }, {
              label: '库存报表',
              children: [
                {
                  label: '进销存日报表',
                  route: '/report/invoicing-daily'
                }
              ]
            }, {
              label: '进货报表',
              children: [
                {
                  label: '商品进货统计',
                  route: '/report/purchase-stats'
                }
              ]
            }, {
              label: '财务报表',
              children: [
                {
                  label: '经营报表',
                  route: '/report/run-report'
                }, {
                  label: '经营日报',
                  route: '/report/run-daily-report'
                }
              ]
            }
          ]
        }
      ]
    }
  },
  methods: {
    onClick (ref, tab) {
      this.$refs[ref][0].doClose()
      this.$emit('change', tab)
      this.$router.push(tab.route)
    }
  }
}
</script>
